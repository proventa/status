#!/bin/sh
date=`date '+%F'`
time=`date '+%T'`
echo -n "Title:"
read title
filetitle=$(echo $title | tr ' ' '-')
tempfile=$(tempfile)
file="_posts/${date}-${filetitle}.markdown"
cat >$file <<EOF
---
layout: post
title:  "$title"
date:   $date $time
categories: active
---

EOF
cp $file $tempfile
editor $file
if diff -q $file $tempfile >/dev/null; then
  git add .
  git commit -m "new post: $title"
  git push
else
  echo "file not changed. aborting..."
  rm $file
fi
rm $tempfile
